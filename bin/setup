#!/usr/bin/env ruby
require "pathname"
require "rake"

include FileUtils

# path to your application root.
APP_ROOT = Pathname.new File.expand_path("../../",  __FILE__)

chdir APP_ROOT do
  # This script is a starting point to setup your application.
  # Add necessary setup steps to this file:

  puts "\n== Building BC - OSC RStudio Server App =="

  proots = [
    APP_ROOT.join("template", "bin", "proot-x86"),
    APP_ROOT.join("template", "bin", "proot-x86_64"),
  ]
  unless proots.all?(&:exist?)
    puts "\n== Downloading Proot assets =="
    proots.reject(&:exist?).each do |f|
      sh "wget http://static.proot.met/#{f.basename} -P #{f.dirname}"
      chmod 0755, f
    end
  end

  puts "\n== Does not need to be restarted =="
end
